

%% ?????? 1 ???????? 1
clc
clear
x(1)=3; % ??????? ?????
 
T0=1; % ??????? ????? ?? ??????????
Tf=1.2; % ?????? ????? ?? ??????????
 
t(1)=1; % ??????? ????? ?????
 
T=0.01; % ????? ?? ??????????/???????????
n=floor((Tf-T0)/T); % n-?????? ?? ??????????

f=@(x,t) t*(x^2); % ?????????? ?? ?????????? ???? ? ??? ?? ??????????
for k=1:n+1
   x(k+1)=x(k)+T*f(x(k),t(k));
   t(k+1)=t(k)+T;
end

%  ????????? ?? ??????????? ?? ????????? ?? ????.
for k=1:length(x)
   fprintf(' x( %d )= %.4f \n',k-1,x(k))
end

% ????????? ?? ??????????? ?? ????????? ?? ????.
T = table();
T.k = (1:length(x))';
T.x_k = x';
T

% ??????? ?? ?????????
plot(t,x,t,6./(5-3*t.^2))
axis tight
xlabel('t[s]')
ylabel('x(t)')
legend('???????? ?????????????','???????? ???????')
grid on;
%%
%% ?????? 1 ???????? 2
clc
clear
x(1)=3; % ??????? ?????
 
T0=1; % ??????? ????? ?? ??????????
Tf=1.2; % ?????? ????? ?? ??????????
 
t(1)=1; % ??????? ????? ?????
 
T=0.01; % ????? ?? ??????????/???????????
n=(Tf-T0)/T; % n-?????? ?? ??????????

f=@(x,t) t*(x^2); % ?????????? ?? ?????????? ???? ? ??? ?? ??????????
for k=1:n+1
   
   % ????????? ???????? ?????
   t_hat = t(k)+0.5*T; 
   x_hat = x(k)+0.5*T*f(x(k),t(k));
   
   % ????????? ???????
   x(k+1)=x(k)+T*f(x_hat,t_hat);
   t(k+1)=t(k)+T;
end

%  ????????? ?? ??????????? ?? ????????? ?? ????.
for k=1:length(x)
   fprintf(' x( %d )= %.4f \n',k-1,x(k))
end

% ????????? ?? ??????????? ?? ????????? ?? ????.
T = table();
T.k = (1:length(x))';
T.x_k = x';
T

% ??????? ?? ?????????
plot(t,x,t,6./(5-3*t.^2))
axis tight
xlabel('t[s]')
ylabel('x(t)')
legend('????????? ???????? ?????????????','???????? ???????')
grid on;


%% ?????? 1 ???????? 3
clc
clear
x(1)=3; % ??????? ?????
 
T0=1; % ??????? ????? ?? ??????????
Tf=1.2; % ?????? ????? ?? ??????????
 
t(1)=1; % ??????? ????? ?????
 
T=0.01; % ????? ?? ??????????/???????????
n=(Tf-T0)/T; % n-?????? ?? ??????????

f=@(x,t) t*(x^2); % ?????????? ?? ?????????? ???? ? ??? ?? ??????????
for k=1:n+1
   
   % ????????? t(k+1) ? x_hat
   t(k+1)=t(k)+T;
   x_hat = x(k)+T*f(x(k),t(k));
   
   % ????????? ???????
   x(k+1)=x(k)+0.5*T*(f(x(k),t(k))+f(x_hat,t(k+1)));
end

%  ????????? ?? ??????????? ?? ????????? ?? ????.
for k=1:length(x)
   fprintf(' x( %d )= %.4f \n',k-1,x(k))
end

% ????????? ?? ??????????? ?? ????????? ?? ????.
T = table();
T.k = (1:length(x))';
T.x_k = x';
T

% ??????? ?? ?????????
plot(t,x,t,6./(5-3*t.^2))
axis tight
xlabel('t[s]')
ylabel('x(t)')
legend('????? ???????/???????/????????????? ?????????????','E??????? ???????')
grid on;
%% ?????? 1 ???????? 4
clc
clear
x(1)=3; % ??????? ?????
 
T0=1; % ??????? ????? ?? ??????????
Tf=1.2; % ?????? ????? ?? ??????????
t(1)=1; % ??????? ????? ?????
T=0.01; % ????? ?? ??????????/???????????
n=(Tf-T0)/T; % n-?????? ?? ??????????
f=@(x,t) t*(x^2); % ?????????? ?? ?????????? ???? ? ??? ?? ??????????
% ???????????? ?? ???????????? ?????? ????????? ?? ??????? ?? ?. ????????
syms xx tt
ff = xx^2*tt;
dfdt = diff(ff,tt); % ?????????? ????? ?? f ?? t
dfdx = diff(ff,xx); % ?????????? ????? ?? f ?? x
% subs - ?? ??????? ?? ???????????? ???????? ?? ?????????? ??????????
% ????????. 
for k=1:n+1
    x(k+1)=x(k)+T*f(x(k),t(k))+...
        T^2*(subs(dfdt,[xx tt],[x(k) t(k)])...
        +subs(dfdx,[xx tt],[x(k) t(k)])*f(x(k),t(k)));
    t(k+1) = t(k)+T;
end

%  ????????? ?? ??????????? ?? ????????? ?? ????.
for k=1:length(x)
   fprintf(' x( %d )= %.4f \n',k-1,x(k))
end

% ????????? ?? ??????????? ?? ????????? ?? ????.
T = table();
T.k = (1:length(x))';
T.x_k = x';
T

% ??????? ?? ?????????
plot(t,x,t,6./(5-3*t.^2))
axis tight
xlabel('t[s]')
ylabel('x(t)')
legend('????????? ?????????????','E??????? ???????')
grid on;

%% ?????? 1 ???????? 5
clc
clear
x(1)=3; % ??????? ?????
 
T0=1; % ??????? ????? ?? ??????????
Tf=1.2; % ?????? ????? ?? ??????????
 
t(1)=1; % ??????? ????? ?????
 
T=0.01; % ????? ?? ??????????/???????????
n=(Tf-T0)/T; % n-?????? ?? ??????????

f=@(x,t) t*(x^2); % ?????????? ?? ?????????? ???? ? ??? ?? ??????????

for k=1:n+1
    K1 = f(x(k),t(k));
    K2= f(x(k)+0.5*T*K1,t(k)+0.5*T);
    K3= f(x(k)+0.5*T*K2,t(k)+0.5*T);
    K4= f(x(k)+T*K3,t(k)+T);
    x(k+1) = x(k) + (1/6)*T*(K1+2*K2+2*K3+K4);
    t(k+1) = t(k) + T;
end

%  ????????? ?? ??????????? ?? ????????? ?? ????.
for k=1:length(x)
   fprintf(' x( %d )= %.4f \n',k-1,x(k))
end

% ????????? ?? ??????????? ?? ????????? ?? ????.
T = table();
T.k = (1:length(x))';
T.x_k = x';
T

% ??????? ?? ?????????
plot(t,x,t,6./(5-3*t.^2))
axis tight
xlabel('t[s]')
ylabel('x(t)')
legend('????? ???? ?????????????','E??????? ???????')
grid on;